<section class="hero">
  <div class="hero__content">
    <h1 class="hero__title">Find your next favorite recipe</h1>
    <p class="hero__subtitle">Simple search, delicious results.</p>

    <form class="hero__search" [formGroup]="searchForm" (ngSubmit)="submitSearch()">
      <mat-form-field appearance="outline" class="hero__field">
        <mat-label>Search recipes</mat-label>
        <input matInput formControlName="q" placeholder="Try “lemon”, “pasta”, “vegan”…"
               aria-label="Search recipes" />
        <button mat-icon-button matSuffix type="submit" aria-label="Search">
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
    </form>
  </div>
</section>

<section class="section">
  <div class="section__header">
    <h2 class="section__title">Featured recipes</h2>
    <a mat-button routerLink="/recipes">Browse all</a>
  </div>

  @if (vm$ | async; as vm) {
    <div class="grid">
      @for (r of vm.featured.items; track r.id) {
        <a class="card" [routerLink]="['/recipes', r.id]">
          <mat-card>
            <img mat-card-image [src]="r.imageUrl" [alt]="r.title" loading="lazy" />
            <mat-card-content>
              <div class="card__title">{{ r.title }}</div>
              <div class="card__meta">
                <app-rating-stars [rating]="r.avgRating" [readonly]="true"></app-rating-stars>
                <span class="dot">•</span>
                <span>{{ r.favoritesCount }} saves</span>
              </div>
              <div class="chips">
                @for (t of r.tags.slice(0, 3); track t) {
                  <span class="chip">{{ t }}</span>
                }
              </div>
            </mat-card-content>
          </mat-card>
        </a>
      }
    </div>
  } @else {
    <app-skeleton-cards [count]="6"></app-skeleton-cards>
  }
</section>

<section class="section section--split">
  <div>
    <div class="section__header">
      <h2 class="section__title">Top rated</h2>
    </div>
    @if (vm$ | async; as vm) {
      <div class="grid grid--compact">
        @for (r of vm.topRated.items; track r.id) {
          <a class="card" [routerLink]="['/recipes', r.id]">
            <mat-card>
              <img mat-card-image [src]="r.imageUrl" [alt]="r.title" loading="lazy" />
              <mat-card-content>
                <div class="card__title">{{ r.title }}</div>
                <div class="card__meta">
                  <app-rating-stars [rating]="r.avgRating" [readonly]="true"></app-rating-stars>
                  <span class="dot">•</span>
                  <span>{{ r.ratingsCount }} ratings</span>
                </div>
              </mat-card-content>
            </mat-card>
          </a>
        }
      </div>
    } @else {
      <app-skeleton-cards [count]="6"></app-skeleton-cards>
    }
  </div>

  <div>
    <div class="section__header">
      <h2 class="section__title">Popular tags</h2>
    </div>
    <div class="tags">
      @for (t of popularTags$ | async; track t) {
        <a class="tag" [routerLink]="['/recipes']" [queryParams]="{ tags: t }">{{ t }}</a>
      }
    </div>
  </div>
</section>
